Completed basic logic of function
